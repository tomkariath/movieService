pipeline {

	agent any
	
	stages{
        stage("Runing unit tests") {
			steps{
				withMaven(maven : 'maven363'){
					bat 'mvn clean install'
				}
			}
		}
            
        stage("Build Docker Image") {
			steps{
				bat 'docker build -t movie-app .'
				bat 'docker tag movie-app tomkariath/movie-app'
				withDockerRegistry([ credentialsId: "dockerCred", url: "" ]) {
					bat 'docker push tomkariath/movie-app'
				}
			}
        }
    }
}